<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Surprise â€” Bon anniversaire Maman !</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#070607;
    --txt:#ffffff;
    --accent:#f5c246;
  }
  html,body{
    height:100%;
    margin:0;
    font-family: 'Roboto', Arial, sans-serif;
    background:var(--bg);
    color:var(--txt);
  }
  .stage{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
    position:relative;
    overflow:hidden;
    text-align:center;
  }
  .panel{
    max-width:1100px;
    width:100%;
    padding:40px;
  }

  /* Zone de texte centrÃ©e */
  .lines-wrapper {
    position: relative;
    min-height: 60vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .line {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    font-size: clamp(20px, 4.2vw, 48px);
    font-weight: 700;
    color: var(--txt);
    opacity: 0;
    transition: opacity .5s ease;
    text-shadow: 0 6px 22px rgba(0,0,0,0.6);
    font-family: 'Playfair Display', serif;
    width: 100%;
    padding: 0 20px;
  }
  .line.show{ opacity:1; }
  .line img{
    display:block;
    margin:20px auto 0;
    max-width:300px;
    border-radius:8px;
    box-shadow:0 10px 30px rgba(0,0,0,0.6);
  }

  .explosion {
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    pointer-events:none;
    opacity:0;
    transition:opacity .6s ease;
  }
  .explosion.show{ opacity:1; }
  .final-images{
    display:flex;
    gap:30px;
    align-items:center;
    justify-content:center;
  }
  .final-images img{
    max-width:40vw;
    width:300px;
    border-radius:8px;
    box-shadow:0 14px 40px rgba(0,0,0,0.6);
  }
  .note{ 
    position:absolute; 
    left:12px; 
    bottom:10px; 
    font-size:12px; 
    color:rgba(255,255,255,0.25); 
  }
  @media (max-width:720px){
    .final-images img{ width:42vw; max-width:220px; }
    .line{ font-size: clamp(18px, 6vw, 32px); }
  }

  /* Animation stroboscopique */
  @keyframes strobe {
    0%   { background: #ff0000; }
    20%  { background: #00ff00; }
    40%  { background: #0000ff; }
    60%  { background: #ffff00; }
    80%  { background: #ff00ff; }
    100% { background: #00ffff; }
  }
  .strobe {
    animation: strobe 0.2s infinite;
  }
</style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="panel" role="main" aria-live="polite">
      <div id="linesWrapper" class="lines-wrapper"></div>

      <!-- final explosion area -->
      <div class="explosion" id="explosion" aria-hidden="true">
        <div class="final-images" id="finalImages">
          <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT7UHe4EmUI1M73baN2mDOx-grtG4ORUvZqmA&s" alt="Image 1" />
          <img src="https://crack-the-egg.com/wp-content/uploads/oeuf_noir_600x600.jpg" alt="Image 2" />
        </div>
      </div>

      <div class="note">Scannez, regardez et profitez ðŸŽ‰</div>
    </div>
  </div>

  <!-- confetti lib -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

  <script>
  const lines = [
    { text: "BON ANNIVERSAIRE MAMAN", sound: "https://www.soundjay.com/human/applause-8.mp3", showJesus:false, final:false },
    { text: "DÃ©jÃ  un demi siÃ¨cle que tu illumines cette Terre par ta prÃ©sence !!", sound: "https://www.soundjay.com/misc/sparkle-02.mp3", showJesus:true, final:false },
    { text: "Et pour te remercier de cela", sound: "https://www.soundjay.com/human/cheer-1.mp3", showJesus:false, final:false },
    { text: "Toute la famille s'est organisÃ©e pour t'offrir", sound: "https://www.soundjay.com/misc/drum-roll-01.mp3", showJesus:false, final:false },
    { text: "pour t'offrir...", sound: "https://www.soundjay.com/misc/drum-roll-02.mp3", showJesus:false, final:false },
    { text: "POUR T'OFFRIR........", sound: "https://www.soundjay.com/misc/drum-roll-03.mp3", showJesus:false, final:false },
    { text: "Je laisse durer encore un peu le suspens", sound: null, showJesus:false, final:false },
    { text: "UNE SORTIE ESCAPE GAME AVEC TOUTE LA FAMILLE ðŸ¥³ðŸ¥³ðŸ¥³", sound: "https://www.soundjay.com/human/applause-8.mp3", showJesus:false, final:true }
  ];

  const wrapper = document.getElementById('linesWrapper');
  lines.forEach((l, idx) => {
    const div = document.createElement('div');
    div.className = 'line';
    div.id = 'line-'+idx;
    div.textContent = l.text;

    if (l.showJesus) {
      const img = document.createElement('img');
      img.src = "https://cdn-useast1.kapwing.com/static/templates/buddy-christ-meme-template-thumbnail-b83659f8.webp";
      img.alt = "JÃ©sus";
      div.appendChild(img);
    }

    wrapper.appendChild(div);
  });

  const explosion = document.getElementById('explosion');

  function playSound(url){
    if(!url) return;
    try{
      const a = new Audio(url);
      a.volume = 0.9;
      a.play().catch(()=>{});
    }catch(e){}
  }

  function speak(text, onend){
    const u = new SpeechSynthesisUtterance(text);
    const voices = window.speechSynthesis.getVoices();
    const frVoices = voices.filter(v => /fr|french|fr-FR/i.test(v.lang + ' ' + v.name));
    if(frVoices.length) u.voice = frVoices[0];
    else if(voices.length) u.voice = voices[0];
    u.rate = 0.95;    
    u.pitch = 1.05;   
    u.volume = 1.0;
    u.onend = onend;
    try {
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(u);
    } catch(e){
      if(onend) setTimeout(onend, 1500);
    }
  }

  let idx = 0;
  function showLine(i){
    document.querySelectorAll('.line').forEach(el => el.classList.remove('show'));
    const line = document.getElementById('line-'+i);
    line.classList.add('show');

    if(lines[i].sound) playSound(lines[i].sound);

    speak(lines[i].text, () => {
      setTimeout(() => {
        if(!lines[i].final){
          idx++;
          if(idx < lines.length) showLine(idx);
        }
      }, 650);
    });

    if (lines[i].final) {
      revealFinale();
    }
  }

  function revealFinale(){
    explosion.classList.add('show');
    document.body.classList.add('strobe');

    playSound("https://www.soundjay.com/human/applause-8.mp3");
    setTimeout(()=> playSound("https://www.soundjay.com/human/cheer-1.mp3"), 300);
    setTimeout(()=> playSound("https://www.soundjay.com/human/cheer-2.mp3"), 600);

    try{
      const duration = 5000;
      const end = Date.now() + duration;
      (function frame(){
        confetti({
          particleCount: 20,
          spread: 60,
          origin: { x: Math.random(), y: Math.random() * 0.6 }
        });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();
    }catch(e){}
  }

  function tryStart(){ 
    if (typeof speechSynthesis !== 'undefined') {
      speechSynthesis.onvoiceschanged = function(){};
    }
    showLine(0); 
  }

  window.addEventListener('load', () => {
    setTimeout(() => {
      try {
        tryStart();
        setTimeout(() => {
          if (!window.speechSynthesis || window.speechSynthesis.speaking === false) {
            showStartOverlay();
          }
        }, 600);
      } catch(e) {
        showStartOverlay();
      }
    }, 300);
  });

  function showStartOverlay(){
    const btn = document.createElement('button');
    btn.textContent = 'Lancer la surprise ðŸŽ‰';
    btn.style.cssText = 'position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:18px 28px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent),#ffdd6b);font-size:18px;font-weight:700;cursor:pointer;z-index:9999';
    document.body.appendChild(btn);
    btn.addEventListener('click', ()=>{
      btn.disabled = true;
      btn.style.opacity = '0.6';
      tryStart();
      setTimeout(()=>btn.remove(), 700);
    });
  }

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' && (window.speechSynthesis && !window.speechSynthesis.speaking)){
      tryStart();
    }
  });
  </script>
</body>
</html>
